<html>
<head>
    
</head>
<body>
    <ul id="messages"></ul>
    <form id="form" action="">
      <input id="input" autocomplete="off" /><button>Send</button>
    </form>

    <button onclick=enterRoom()>방 123에 입장</button>
    <button onclick=newRoom()>방 만들기</button>
    <button onclick=getRoomList()>방 리스트 요청</button>
    <button onclick=mandateMaster()>방장 위임 </button>
    <button onclick=setSecretpw()>비밀번호 변경 </button>
    <button onclick=addBlockUser()>targetid 유저 차단</button>
    <button onclick=freeBlockUser()>targetid 유저 해제</button>
    <button onclick=addMuteUser()>targetid 유저 음소거</button>
    <button onclick=freeMuteUser()>targetid 유저 음소거 해제</button>

    <script src="https://cdn.socket.io/4.3.2/socket.io.min.js"
    integrity="sha384-KAZ4DtjNhLChOB/hxXuKqhMLYvx3b5MlT55xPEiNmREKRzeEm+RVPlTnAn0ajQNs"
    crossorigin="anonymous"></script>
    <script>
    const socket = io('http://localhost:3000');
    
    const existRoom = "123";
    const room = 'testRoom';
    const userId = 'no_init_99987';
    const secretpw = '123';

    socket.on('room', function (data) {
        console.log('room', data);
    });

    socket.on('getUser', function (data) {
        console.log('getUesr');
        socket.emit('getUser', {roomName:room, userId:userId, secretpw:secretpw});
    });

    socket.on('youKick', () => {
        console.log("강퇴당함!");
    })

    socket.on('chat', function(data, msg){
        console.log('onchat', data, msg);
    });

    socket.on('/api/post/newRoom', function(data){
        console.log('/api/post/newRoom', data);
    });

    function newRoom(){
        socket.emit('/api/post/newRoom', room, userId, secretpw);
    }

    function enterRoom() {
        socket.emit('getUser', {roomName: existRoom, userId: userId});
    }

    socket.on('/api/get/RoomList', function(data){
        console.log('/api/get/RoomList', data);
    });

    function getRoomList(){
        socket.emit('/api/get/RoomList');
    }

    function mandateMaster(){
        socket.emit('/api/post/mandateMaster', room, 'jeyoon');
    }

    function setSecretpw(){
        socket.emit('/api/put/setSecretpw', room, secretpw, '456');
    }

    function addBlockUser(){
        socket.emit('/api/put/addblockuser', room, 'targetid');
    }

    function freeBlockUser(){
        socket.emit('/api/put/freeblockuser', room, 'targetid');
    }

    function addMuteUser(){
        socket.emit('/api/put/addmuteuser', room, 'targetid');
    }

    function freeMuteUser(){
        socket.emit('/api/put/freemuteuser', room, 'targetid');
    }

    var form = document.getElementById('form');
    var input = document.getElementById('input');
    form.addEventListener('submit', function(e) {
        e.preventDefault();
        if (input.value) {
        socket.emit('chat', existRoom, userId, input.value);
        input.value = '';
        }
    });
</script>
</body>

</html>